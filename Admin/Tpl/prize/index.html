<include file="public/header"/>

<div class="am-cf admin-main">
    <include file="public/sidebar"/>
    <!-- content start -->
    <div class="admin-content">
        <div class="admin-content-body">
            <div class="am-cf am-padding am-padding-bottom-0">
                <div class="am-fl am-cf"><strong class="am-text-primary am-text-lg">奖品信息</strong>
                    <small></small>
                </div>
            </div>

            <hr>

            <div class="am-g">
                <div class="am-u-sm-12 am-u-md-6">
                    <div class="am-btn-toolbar">
                        <div class="am-btn-group am-btn-group-xs">
                            <button onclick="add()" type="button" class="am-btn am-btn-default"><span
                                    class="am-icon-plus"></span> 新增
                            </button>
                            <!--<button type="button" class="am-btn am-btn-default"><span class="am-icon-save"></span> 保存</button>-->
                            <!--<button type="button" class="am-btn am-btn-default"><span class="am-icon-archive"></span> 审核</button>-->
                            <!--<button onclick="ExportExcel('{$Think.GET.query_text}')" type="button"-->
                            <!--class="am-btn am-btn-default"><span class="am-icon-save"></span> 导出EXCEL-->
                            <!--</button>-->
                            <button onclick="del()" type="button" class="am-btn am-btn-default"><span
                                    class="am-icon-trash-o"></span> 删除
                            </button>
                        </div>
                    </div>
                </div>
                <!--<div class="am-u-sm-12 am-u-md-3">-->
                <!--<div class="am-form-group">-->
                <!--<select onchange="queryState(this)" data-am-selected="{btnSize: 'sm'}">-->
                <!--<option value="all" <if condition="$Think.get.state  ">selected="selected"</if>>全部</option>-->
                <!--<option value="1" <if condition="$Think.get.state eq 1">selected="selected"</if>>已领卡</option>-->
                <!--<option value="0" <if condition="$Think.get.state eq '0'">selected="selected"</if>>未领卡</option>-->

                <!--</select>-->
                <!--</div>-->
                <!--</div>-->
                <!--<div class="am-u-sm-12 am-u-md-3">-->
                <!--<form method="get" action="{:U('Staff/index')}">-->
                <!--<div class="am-input-group am-input-group-sm">-->

                <!--<input name="query_text" type="text" value="{$Think.GET.query_text}" class="am-form-field">-->
                <!--<input name="m" type="hidden" value="Staff">-->
                <!--<input name="a" type="hidden" value="index">-->
                <!--<span class="am-input-group-btn">-->
                <!--<button class="am-btn am-btn-default" onclick="submit()" type="button">搜索</button>-->
                <!--</span>-->

                <!--</div>-->
                <!--</form>-->
                <!--</div>-->
            </div>

            <div class="am-g">
                <div class="am-u-sm-12">

                    <table class="am-table am-table-striped am-table-hover table-main">
                        <thead>
                        <tr>
                            <th class="table-check"><input id="select-all" type="checkbox"/></th>
                            <th class="table-id">ID</th>
                            <th class="table-title">奖品名称</th>
                            <th class="table-type">现库存</th>

                            <th class="table-date am-hide-sm-only">总库存</th>
                            <th class="table-date am-hide-sm-only">概率（百分比）</th>
                            <th class="table-date am-hide-sm-only">排序</th>
                            <th class="table-set">操作</th>
                        </tr>
                        </thead>
                        <tbody>

                        <volist name="list" id="vo">
                            <tr>
                                <td><input data-id="{$vo.id}" type="checkbox"/></td>
                                <td>{$vo.id}</td>
                                <td>{$vo.title}</td>
                                <td>{$vo['all_count']-$vo['used_count']}</td>
                                <td>{$vo.all_count}</td>
                                <td class="am-hide-sm-only">
                                    {$vo.percentage}
                                </td>
                                <td>
                                    {$vo.sort}
                                </td>
                                <!--<td class="am-hide-sm-only">-->
                                <!--<if condition="$vo.state eq 1">-->
                                <!--已启用-->
                                <!--<else/>-->
                                <!--<span class="am-text-danger">已禁用</span>-->
                                <!--</if>-->
                                <!--</td>-->
                                <td>
                                    <div class="am-btn-toolbar">
                                        <div class="am-btn-group am-btn-group-xs">
                                            <!--<if condition="$vo.state neq 1">-->
                                            <!--<button onclick="setState({$vo.id})"-->
                                            <!--class="am-btn am-btn-default am-btn-xs am-text-secondary"><span-->
                                            <!--class="am-icon-pencil-square-o"></span> 领卡-->
                                            <!--</button>-->
                                            <!--</if>-->
                                            <button onclick="window.location.href='{:U(MODULE_NAME.'/edit',array('id'=>$vo['id']))}'"
                                                    class="am-btn am-btn-default am-btn-xs am-text-secondary"><span
                                                    class="am-icon-pencil-square-o"></span> 编辑
                                            </button>
                                            <!--<button class="am-btn am-btn-default am-btn-xs am-hide-sm-only"><span class="am-icon-copy"></span> 复制</button>-->
                                            <!--<button class="am-btn am-btn-default am-btn-xs am-text-danger am-hide-sm-only"><span class="am-icon-trash-o"></span> 删除</button>-->
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </volist>


                        </tbody>
                    </table>

                    <div class="am-cf">
                        <div class="am-fr">
                            {$page}
                        </div>
                    </div>
                    <hr/>
                    <p>注：.....</p>

                </div>

            </div>
        </div>

        <footer class="admin-content-footer">
            <hr>
            <p class="am-padding-left">© 2014 AllMobilize, Inc. Licensed under MIT license.</p>
        </footer>

    </div>
    <!-- content end -->
    <div class="am-modal am-modal-loading am-modal-no-btn" tabindex="-1" id="my-modal-loading">
        <div class="am-modal-dialog">
            <div class="am-modal-hd">处理中...</div>
            <div class="am-modal-bd">
                <span class="am-icon-spinner am-icon-spin"></span>
            </div>
        </div>
    </div>
    <include file="public/footer"/>
    <script>
        function setState(id) {
            var res = window.confirm("是否确定领卡？");
            var api_url = '{:U("Register/setState")}';
            if (res) {
                // $('#my-modal-loading').modal();
                var data = {id: id};
                $.post(api_url, data, function (data) {
                    //     $('#my-modal-loading').modal('close');
                    if (data.state == "-1") {
                        alert("操作失败");
                    } else if (!data) {
                        alert("提交失败");
                    } else {
                        alert("操作成功");
                        window.location.reload();
                    }
                });
            } else {
                return false;
            }
        }

    </script>